@startuml Patient History and Reports System

actor User
participant Browser
participant "patient_history.php" as HistoryPHP
participant "reports.php" as ReportPHP
database Database

' Patient History View
group Patient History
    User -> Browser: Access patient history
    Browser -> HistoryPHP: GET request
    HistoryPHP -> Database: Get patient list
    Database --> Browser: Return patients

    ' Search History
    User -> Browser: Select patient and search
    Browser -> HistoryPHP: AJAX request
    HistoryPHP -> Database: Query multiple tables\n(family, deworming, bp,\nblood sugar, tetanus)
    Database --> HistoryPHP: Return all records
    HistoryPHP --> Browser: Display in tabs

    ' Export Options
    User -> Browser: Click export option\n(CSV/Excel/PDF/Print)
    Browser -> Browser: Format data
    Browser --> User: Download/Show report
end

' Reports Generation
group Reports Management
    User -> Browser: Access reports page
    Browser -> ReportPHP: GET request
    
    ' Generate Report
    User -> Browser: Select report type and dates
    Browser -> ReportPHP: Request report generation
    ReportPHP -> Database: Query data for\nselected date range
    Database --> ReportPHP: Return filtered data
    ReportPHP -> ReportPHP: Generate PDF report
    ReportPHP --> Browser: Open report in new tab
end

note right of Browser
  Available Reports:
  - Medicine Inventory
  - Family Planning
  - Deworming
  - BP Monitoring
  - Blood Sugar
  - Tetanus Toxoid
end note

note right of HistoryPHP
  History Categories:
  - Family Planning
  - Deworming
  - BP Monitoring
  - Blood Sugar
  - Tetanus Toxoid
end note

@enduml 