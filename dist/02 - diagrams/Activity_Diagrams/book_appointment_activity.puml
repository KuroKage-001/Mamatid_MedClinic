@startuml
skinparam defaultTextAlignment center
skinparam ArrowThickness 2
skinparam ActivityBorderThickness 2
skinparam ActivityDiamondBackgroundColor white
skinparam ActivityDiamondBorderThickness 2

title Patient Appointment Management Subsystem

|Patient|
start
if (Action?) then (Create new appointment)
  :View Available Doctors/Health Worker;
  :Select Doctor/Health Worker;
  :Fill Booking Form;
  :Submit Form;
  
  |System|
  :Process Booking;
  if (Validation) then (success)
    :Create Appointment;
    :Show Success Message;
  else (failed)
    :Show Error Message;
    ->retry;
  endif
  
else if (View appointments) then (view list)
  :View Appointment List;
  
  |System|
  :Display Appointments;
  
  |Patient|
  if (Search needed?) then (yes)
    :Search Appointment;
    
    |System|
    :Filter Results;
    
    |Patient|
    if (Track status?) then (yes)
      :Track Appointment Status;
      
      |System|
      :Display Status Details;
    else (no)
    endif
  else (no)
  endif
  
else if (Modify existing) then (update)
  :View Appointment List;
  :Select Appointment;
  
  |System|
  :Display Appointment Details;
  
  |Patient|
  if (Action type?) then (update)
    :Update Appointment;
    :Submit Changes;
    
    |System|
    :Process Update;
    if (Valid update?) then (success)
      :Update Appointment Record;
      :Show Success Message;
    else (failed)
      :Show Error Message;
      ->retry;
    endif
    
  else if (cancel)
    :Cancel Appointment;
    
    |System|
    :Process Cancellation;
    if (Can cancel?) then (allowed)
      :Mark Appointment as Cancelled;
      :Show Success Message;
    else (not allowed)
      :Show Error Message;
      ->retry;
    endif
  endif
endif

stop

@enduml